<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>AI Comic Studio</title>
    <style>
        :root { --primary: #ffcc00; --dark: #1a1a1a; }
        body { font-family: 'Comic Sans MS', cursive; background: #eee; margin: 0; overflow-x: hidden; }
        
        #home-screen { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; }
        .selector-container { display: flex; gap: 40px; margin-top: 30px; }
        .card { width: 300px; padding: 40px; background: white; border: 5px solid var(--dark); cursor: pointer; transition: 0.3s; box-shadow: 10px 10px 0px var(--dark); text-align: center; }
        .card:hover { transform: translate(-5px, -5px); box-shadow: 15px 15px 0px var(--primary); }
        
        #editor-screen { display: none; padding: 20px; text-align: center; }
        
        /* HOJA REALISTA: Formato A4 (proporciÃ³n 1:1.4) */
        .canvas-area { 
            border: 2px solid #999; 
            background: white; 
            margin: 20px auto; 
            width: 500px;  /* Ancho */
            height: 700px; /* Alto rectangular */
            position: relative; 
            cursor: crosshair;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .guia-linea { position: absolute; background: black; transform-origin: 0 50%; pointer-events: none; z-index: 10; }
        #linea-temporal { background: rgba(255, 0, 0, 0.5); height: 2px !important; z-index: 5; }

        .hidden { display: none !important; }
        .controls { margin-bottom: 20px; background: white; padding: 15px; border-bottom: 3px solid black; display: flex; justify-content: center; gap: 15px; align-items: center; }
        button { padding: 10px 20px; font-weight: bold; border: 3px solid black; cursor: pointer; background: var(--primary); }
    </style>
</head>
<body>

    <div id="home-screen">
        <h1>Â¿QUÃ‰ VAMOS A CREAR HOY?</h1>
        <div class="selector-container">
            <div class="card" onclick="mostrarEditor('ilustracion')"><h2>ðŸŽ¨ ILUSTRACIÃ“N</h2><p>Una sola imagen Ã©pica.</p></div>
            <div class="card" onclick="mostrarEditor('comic')"><h2>ðŸ“š CÃ“MIC / MANGA</h2><p>DiseÃ±a tus viÃ±etas.</p></div>
        </div>
    </div>

    <div id="editor-screen">
        <div class="controls">
            <button onclick="irAHome()">â¬… Volver</button>
            <strong id="modo-titulo">Editor</strong>
            <button onclick="limpiarLienzo()" style="background: #ff4444; color: white;">Limpiar Todo</button>
            <button onclick="alert('Siguiente: Conectar IA')">Â¡Listo!</button>
        </div>
        
        <p>Pincha y arrastra para dibujar los marcos de tus viÃ±etas:</p>
        <div class="canvas-area" id="lienzo">
            <div id="linea-temporal" class="guia-linea" style="display:none"></div>
        </div>
    </div>

    <script>
        let dibujando = false;
        let xInicio, yInicio;
        const lienzo = document.getElementById('lienzo');
        const lineaTemporal = document.getElementById('linea-temporal');

        function mostrarEditor(modo) {
            document.getElementById('home-screen').classList.add('hidden');
            document.getElementById('editor-screen').style.display = 'block';
        }

        function irAHome() {
            document.getElementById('home-screen').classList.remove('hidden');
            document.getElementById('editor-screen').style.display = 'none';
        }

        function limpiarLienzo() {
            const lineas = lienzo.querySelectorAll('.real-line');
            lineas.forEach(l => l.remove());
        }

        // NUEVO MOTOR DE ARRASTRE
        lienzo.addEventListener('mousedown', (e) => {
            dibujando = true;
            const rect = lienzo.getBoundingClientRect();
            xInicio = e.clientX - rect.left;
            yInicio = e.clientY - rect.top;
            
            lineaTemporal.style.display = 'block';
            actualizarLinea(lineaTemporal, xInicio, yInicio, xInicio, yInicio);
        });

        window.addEventListener('mousemove', (e) => {
            if (!dibujando) return;
            const rect = lienzo.getBoundingClientRect();
            const xActual = e.clientX - rect.left;
            const yActual = e.clientY - rect.top;
            
            actualizarLinea(lineaTemporal, xInicio, yInicio, x
